#!/usr/bin/python
#import scapy
from scapy.all import *
targetHost="127.0.0.1"
targetPort=(1,1024)


conf.L3socket=L3RawSocket

#for i in range(70,87):
#    targetPort.append(i)
#print targetPort


a = IP(dst=targetHost)/TCP(dport= targetPort ,flags="S")
ans , unans = sr(a)
ans.summary(lfilter = lambda (s,r): r.sprintf("%TCP.flags%") == "SA",prn=lambda(s,r):r.sprintf("%TCP.sport% is open"))
"""
egin emission:
Finished sending 1024 packets.
.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*..*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*..*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*
.....................................................................................................................................................................................................................................................................................*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*..........*.*.*.*.*.*.*.*.*....................*...*..............*........*............*.*.*..*.*.*.*.*....................*............*...............*..........*.*.*.*.*.*.*.*.*....*.......*................*.............*......................*.*.*.*.*.*.*.*.*...................*.....................................*............*.....*.*.*.*.*.*.*.*.*.......................*.*........*...............*.............*...*.*.*.*.*.*.*.*.*.*.*.*.*.*.............*...........*.........*...........*............*............*.*.*.*.*.*.*..................*...........*.....*.........*...........*......*............*.*.*.*.*.*.*.*.*.*.*..............*..................*..........*......*....*.................*.*.*.*.*.*.*.*.*.*.*....*..........*...

"""
